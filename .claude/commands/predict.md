# OKBET Arena 夺冠概率预测

请根据以下方法论预测各 AI 的夺冠概率。

## 步骤 0: 读取历史预测日志

首先读取 `predict-log.md` 文件，了解之前的预测记录和战况变化趋势。如果文件不存在则跳过此步骤。

分析历史数据时关注：
- 各 AI 净资产的变化趋势（上升/下降）
- 之前预测的准确性
- 关键市场的结算情况

## 步骤 1: 获取数据

调用以下 MCP 工具获取实时数据：
1. `mcp__okbet-arena__get_competition_summary` - 获取排行榜、余额、PnL、胜率、交易次数
2. `mcp__okbet-arena__get_all_positions` - 获取所有 AI 的持仓详情

## 步骤 1.5: 新开仓监控与持仓变化（关键！）

将当前持仓与 `predict-log.md` 中上次记录的持仓进行对比。

### ⚠️ 高优先级警报检查

**必须首先检查以下情况，如触发则立即重新评估概率：**

1. **GPT 买入 Kevin Warsh YES** → 完全改变格局！GPT 不再是"躺赢"角色
2. **任何 AI 大额新开仓（>$15）在1月结算市场** → 可能拉开差距
3. **领先者在关键市场加仓** → 巩固优势
4. **落后者开出独有高价值持仓** → 翻盘机会

### 需要追踪的变化类型

| 变化类型 | 重要性 | 说明 |
|----------|--------|------|
| **新开仓** | 🔴 极高 | 上次没有，这次有的市场 |
| **平仓/结算** | 🟡 中 | 上次有但这次消失的市场 |
| **加仓** | 🟡 中 | 同一市场投资额增加 |
| **减仓** | 🟢 低 | 同一市场投资额减少 |

### 分析方法

对每个 AI：
1. 列出本次活跃持仓（unrealized_pnl ≠ 0）
2. 与上次记录对比，找出差异
3. 重点关注：
   - **新开仓（任何金额）** - 特别是1月结算的市场
   - 大额新开仓（>$10）
   - 重要市场结算（政治/经济类）
   - 盈亏显著变化（>$1）

### 输出格式

```
### 新开仓监控

**⚠️ 警报：**
- [如有高优先级警报，列出并说明影响]

**本次新开仓：**
| AI | 市场 | 方向 | 金额 | 结算日期 | 影响评估 |
|----|------|------|------|----------|----------|

**本次结算：**
| AI | 市场 | 结果 | 盈/亏 |
|----|------|------|-------|

**其他持仓变化：**
- [AI]: [加仓/减仓] [市场] $X → $Y
- [AI]: [盈亏变化] [市场] +/-$X
```

**注意：** 如果是首次记录或上次日志无持仓详情，跳过此步骤。

## 步骤 1.6: 结算时间分析（1月份视角）

**核心原则：只有1月31日前结算的市场才影响最终排名！**

### 分类当前所有活跃持仓

将所有活跃持仓按结算时间分类：

| 结算时间 | 影响 | 分析重点 |
|----------|------|----------|
| **今日/明日** | 即时影响 | 体育赛事，关注同向/对向 |
| **1月29日** | Fed决议 | 所有AI同向押注，影响有限 |
| **1月31日** | 决定性 | Kevin Warsh、地缘政治 |
| **2月后** | ⚪ 无影响 | 不计入概率分析 |

### 输出格式

```
### 1月结算市场分析

**🔴 决定性市场（可能改变格局）：**
| 市场 | 结算日 | 持仓AI | 未持仓AI | 场景分析 |
|------|--------|--------|----------|----------|
| Kevin Warsh | 1/31 | Claude/Grok/DeepSeek YES | GPT 无 | Warsh成功→追平，失败→GPT躺赢 |

**🟡 中等影响市场：**
| 市场 | 结算日 | 各AI持仓 | 说明 |
|------|--------|----------|------|

**⚪ 无影响市场（2月后结算）：**
| 市场 | 结算日 | 持仓AI | 备注 |
|------|--------|--------|------|
| Lula 巴西总统 | 2026/10 | GPT | 不影响1月比赛 |
| Russia Ukraine 停火 | 3/31 | 多个AI | 不影响1月比赛 |
```

**关键发现：**
- 列出哪些AI的"独有优势"实际上不会在1月结算
- 识别真正决定比赛的1-2个关键市场

## 步骤 2: 分析核心指标

| 指标 | 说明 | 权重 |
|------|------|------|
| **净资产差距** | Balance 已包含未实现盈亏，直接反映当前排名 | 高 |
| **活跃持仓数量** | 只统计 unrealized_pnl ≠ 0 的持仓（见下方说明） | 中 |
| **活跃投资额** | 活跃持仓的投资额总和，反映真实风险敞口 | 中 |
| **历史胜率** | 参考价值有限，胜率高不代表盈利高 | 低 |

### 重要：区分活跃持仓与已结算持仓

API 返回的持仓数据包含大量已结算但未 claim 的仓位（主要是体育赛事）。这些仓位的 `unrealized_pnl = 0.00`，不会再产生任何盈亏变化。

**判断方法：**
- `unrealized_pnl ≠ 0` → 活跃持仓，市场尚未结算，仍有波动
- `unrealized_pnl = 0` → 已结算或无波动，不计入分析

**分析时应该：**
1. 过滤出活跃持仓（unrealized_pnl ≠ 0）
2. 统计活跃持仓数量和活跃投资额
3. 基于活跃持仓评估翻盘能力

**注意：** 总持仓数量（position_count）和总投资额（total_invested）参考意义有限，因为包含大量已结算仓位。

## 步骤 3: 综合评估夺冠概率

不要使用固定的概率区间，而是基于以下因素综合判断：

**核心考量：**
1. **净资产差距** - 差距越大，翻盘难度越高
2. **活跃持仓质量** - 高价值政治/经济市场 vs 低价值体育赛事
3. **剩余时间** - 距比赛结束越近，领先者优势越大
4. **历史趋势** - 参考 predict-log.md 中的净资产变化趋势

**判断原则：**
- 大额差距（如 $80+）在剩余时间有限时几乎无法追赶
- 活跃持仓少、投资额低的 AI 翻盘能力极弱
- 概率应反映真实的获胜可能性，不要因为"给每个 AI 一点机会"而虚高

### 重要：翻盘可行性检验（必须执行）

在分配概率之前，必须对每个落后者进行翻盘可行性检验：

**检验方法：**
```
最大可能收益 = 活跃投资额 × 2（假设所有持仓翻倍，这已经是极端乐观情况）
翻盘所需 = 与第一名的差距
```

**判断标准：**
- 如果 `最大可能收益 < 翻盘所需`，则该 AI 胜率应为 **<1%**
- 不要给不可能翻盘的 AI 分配 3%、5%、7% 这样的"人情概率"
- 问自己：如果模拟 100 次比赛，这个 AI 真的能赢 X 次吗？

**示例：**
- DeepSeek 活跃投资额 $65，落后 $102 → 即使全部翻倍也只有 $65 收益 → **<1%**
- Gemini 活跃投资额 $89，落后 $80 → 即使全部翻倍勉强够，但需要同时领先者大亏 → **<1%**

**教训：** 之前给 Gemini 7%、DeepSeek 3% 是严重错误。这意味着 100 次比赛中 Gemini 赢 7 次、DeepSeek 赢 3 次，这在数学上不合理。

## 步骤 4: 应用调整因子

**上调概率：**
- 持有高价值政治/经济类市场（波动大）
- 与领先者在关键市场持有相反方向（有反超机会）
- 总投资额高于平均水平

**下调概率：**
- 持仓数量过少（翻盘机会有限）
- 总投资额过低（保守策略难以追赶）
- 持仓方向与领先者高度重合

## 步骤 5: 识别关键对决市场

找出各 AI 持有相反方向的市场，这些市场结果将直接影响相对排名：
- 政治事件：选举、任命、地缘政治
- 经济政策：Fed 利率决议
- 加密货币：BTC 价格里程碑

## 步骤 6: 输出预测结果

使用以下格式输出：

```
## 夺冠概率预测

| AI | 夺冠概率 | 净资产 | 与第一差距 | 关键理由 |
|----|----------|--------|------------|----------|
| XXX | XX% | $XXX | $XX | [简要说明] |
...

## 关键对决市场

| 市场 | AI A 方向 | AI B 方向 | 影响 |
|------|-----------|-----------|------|
...

## 分析总结

[简要总结竞争格局和关键变量]
```

## 注意事项

1. **Balance 已包含未实现盈亏** - 不要重复计算
2. **PnL = Balance - 250** - 初始资金为 $250
3. **概率之和必须为 100%**
4. **比赛截止日期**: January 31, 2026 23:59:59 UTC
5. 距比赛结束越近，领先者优势越大

## 步骤 7: 记录预测日志

完成预测后，需要更新 `predict-log.md` 文件，包括两部分：

### 7.1 追加 Markdown 日志（人类可读）

在文件中 `<!-- JSON_DATA_START -->` 标记之前追加新的日志条目：

```markdown
---

## [YYYY-MM-DD HH:MM UTC]

### 排行榜快照
| 排名 | AI | 净资产 | PnL | 变化 |
|------|-----|--------|-----|------|
| 1 | XXX | $XXX | $XX | +/-$X |
...

### 夺冠概率预测
| AI | 概率 | 上次概率 | 变化 |
|----|------|----------|------|
| XXX | XX% | XX% | +/-X% |
...

### 关键活跃持仓
只记录 unrealized_pnl ≠ 0 且投资额 > $5 的持仓，格式：
| AI | 市场 | 方向 | 投资额 | 浮盈亏 |
|----|------|------|--------|--------|
| GPT | Lula 巴西总统 | YES | $30 | +$3.94 |
| Claude | Kevin Warsh Fed | YES | $30 | +$4.01 |
...

### 持仓变化（vs 上次）
- [新开仓/平仓/加减仓/盈亏显著变化]

### 关键事件
- [记录影响战局的重要市场结算]

### 分析备注
[简要说明本次预测的主要考量因素]
```

### 7.2 更新 JSON 数据块（机器可读）

文件末尾有一个 JSON 数据块，供前端可视化页面使用。需要更新这个数据块：

```markdown
<!-- JSON_DATA_START -->
```json
{
  "lastUpdate": "2026-01-07T08:30:00Z",
  "current": {
    "gpt-5.1": { "probability": 52, "balance": 209.06, "pnl": -40.94 },
    "claude-sonnet-4.5": { "probability": 30, "balance": 185.21, "pnl": -64.79 },
    "grok-4": { "probability": 17, "balance": 178.09, "pnl": -71.91 },
    "gemini-3-pro": { "probability": 0.5, "balance": 135.59, "pnl": -114.41 },
    "deepseek-r1": { "probability": 0.5, "balance": 113.48, "pnl": -136.52 }
  },
  "history": [
    { "time": "01/05 12:00", "claude-sonnet-4.5": 38, "gpt-5.1": 35, "grok-4": 18, "gemini-3-pro": 6, "deepseek-r1": 3 },
    { "time": "01/05 15:30", "claude-sonnet-4.5": 38, "gpt-5.1": 36, "grok-4": 17, "gemini-3-pro": 6, "deepseek-r1": 3 },
    ...更多历史记录...
    { "time": "01/07 08:30", "claude-sonnet-4.5": 30, "gpt-5.1": 52, "grok-4": 17, "gemini-3-pro": 0.5, "deepseek-r1": 0.5 }
  ],
  "insights": [
    "GPT-5.1 leads with Lula Brazil position (+$3.32)",
    "Claude trailing by $23.85, Kevin Warsh is key (+$4.94)",
    "Grok 4 holding steady with Kevin Warsh (+$5.16)"
  ]
}
```
<!-- JSON_DATA_END -->
```

**JSON 字段说明：**
- `lastUpdate`: ISO 8601 格式的更新时间
- `current`: 当前各 AI 的概率、余额、PnL
- `history`: 历史概率数据数组，每次预测添加一条
- `insights`: 关键洞察数组（3-5 条简短描述）

**更新步骤：**
1. 读取文件末尾的 JSON 数据块
2. 更新 `lastUpdate` 为当前时间
3. 更新 `current` 为最新数据
4. 在 `history` 数组末尾追加本次概率记录
5. 更新 `insights` 为本次分析的关键点

注意：
- 使用 Edit 工具更新文件
- 如果文件不存在或没有 JSON 数据块，需要创建完整结构
- "变化"列需要与上次日志记录对比计算
- 日志文件路径: `C:\Users\YWI1WX\working\okbet\predict-log.md`
